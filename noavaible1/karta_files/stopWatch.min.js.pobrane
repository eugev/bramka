(function($){$.fn.stopWatch=function(options){if($(this).length==0)return this;var time=15;var endTimestamp=Math.floor(Date.now()/1000)+time;var timeDiff=0;if(parseInt($(this).attr('data-time'))>0)time=parseInt($(this).attr('data-time'));if(parseInt($(this).attr('data-time-server'))>0)timeDiff=parseInt($(this).attr('data-time-server'))-Math.floor(Date.now()/1000);if(parseInt($(this).attr('data-timestamp-end'))>0)endTimestamp=parseInt($(this).attr('data-timestamp-end'));var settings=$.extend({time:time,timeDiff:timeDiff,endTimestamp:endTimestamp,complete:function(){},tick:function(){}},options);this.settings=settings;$(this).attr('data-time',settings.time);$(this).attr('data-timestamp-end',settings.endTimestamp);this._tick=function(){var currentTime=Math.floor(Date.now()/1000)+this.settings.timeDiff;var totalSeconds=this.settings.time*60;var passedSeconds=totalSeconds-(this.settings.endTimestamp-currentTime);var totalSecondsLeft=totalSeconds-passedSeconds;var minutesLeft=Math.floor(totalSecondsLeft/60);var secondsLeft=totalSecondsLeft%60;var minutesStr=""+(minutesLeft<10?"0":"")+minutesLeft;var secondsStr=""+(secondsLeft<10?"0":"")+secondsLeft;$(this).find('.value').html(minutesStr+":"+secondsStr);var percent=passedSeconds/totalSeconds;if(percent>=0&&percent<=0.5){var angle=90-(Math.round(360*percent));$(this.selector).find('.gauge').css('background-image','linear-gradient('+angle+'deg, #f00 50%, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0)), linear-gradient(270deg, #f00 50%, #fff 50%, #fff)').css('border-radius','50%')}
if(percent>0.5&&percent<=1){var angle=90-(Math.round(360*percent));$(this.selector).find('.gauge').css('background-image','linear-gradient(90deg, #fff 50%, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0)), linear-gradient('+angle+'deg, #f00 50%, #fff 50%, #fff)').css('border-radius','0 50% 50% 0')}
if(percent<1&&percent>=0){this.settings.tick()}else{this.settings.complete();if(that._pid>0){clearTimeout(that._pid);that._pid=0}}};this._tick();var that=this;that._pid=setInterval(function(){that._tick()},1000);return this}}(jQuery))